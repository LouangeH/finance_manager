{% extends 'base.html' %}

{% block title %}Accueil{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Titre et message de bienvenue -->
    <h1 class="text-center text-primary fw-bold mb-4">
        Bienvenue dans le Syst√®me de Gestion de la Ferme üêá
    </h1>
    <p class="text-center text-muted">G√©rez efficacement vos lapins, leurs reproductions, leurs traitements, et bien plus encore.</p>

    <!-- Statistiques g√©n√©rales -->
    <div class="row mt-4">
        <div class="col-md-3">
            <div class="card shadow border-primary">
                <div class="card-body text-center">
                    <h5 class="card-title text-primary">Total Lapins</h5>
                    <p class="display-4 text-primary">{{ total_lapins }}</p>
                    <i class="fas fa-paw fa-2x text-primary"></i>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card shadow border-success">
                <div class="card-body text-center">
                    <h5 class="card-title text-success">Lapereaux</h5>
                    <p class="display-4 text-success">{{ total_lapereaux }}</p>
                    <i class="fas fa-baby fa-2x text-success"></i>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card shadow border-warning">
                <div class="card-body text-center">
                    <h5 class="card-title text-warning">Reproductions en cours</h5>
                    <p class="display-4 text-warning">{{ reproductions_en_cours }}</p>
                    <i class="fas fa-venus-mars fa-2x text-warning"></i>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card shadow border-info">
                <div class="card-body text-center">
                    <h5 class="card-title text-info">Traitements administr√©s</h5>
                    <p class="display-4 text-info">{{ traitements_total }}</p>
                    <i class="fas fa-prescription-bottle-alt fa-2x text-info"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Rappels et derni√®res actions -->
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card shadow border-danger">
                <div class="card-header bg-danger text-white">Rappels</div>
                <div class="card-body">
                    <ul>
                        {% for rappel in rappels %}
                            <li><i class="fas fa-bell text-danger"></i> {{ rappel }}</li>
                        {% empty %}
                            <li class="text-muted">Aucun rappel pour le moment.</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card shadow border-secondary">
                <div class="card-header bg-secondary text-white">Derni√®res Actions</div>
                <div class="card-body">
                    <ul>
                        {% for action in dernieres_actions %}
                            <li><i class="fas fa-history text-secondary"></i> {{ action }}</li>
                        {% empty %}
                            <li class="text-muted">Aucune action r√©cente.</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Graphiques -->
    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">R√©partition des Lapins</div>
                <div class="card-body">
                    <canvas id="lapinsChart"></canvas>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card shadow">
                <div class="card-header bg-info text-white">Naissances par Mois</div>
                <div class="card-body">
                    <canvas id="naissancesChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Acc√®s rapide -->
    <div class="row mt-5 text-center">
        <div class="col">
            <a href="{% url 'ajouter_lapin' %}" class="btn btn-primary me-3">
                <i class="fas fa-plus-circle me-2"></i> Ajouter un Lapin
            </a>
            <a href="{% url 'ajouter_reproduction' %}" class="btn btn-warning me-3">
                <i class="fas fa-plus-circle me-2"></i> Ajouter une Reproduction
            </a>
            <a href="{% url 'liste_lapins' %}" class="btn btn-secondary me-3">
                <i class="fas fa-list-ul me-2"></i> Voir Liste des Lapins
            </a>
            <a href="{% url 'statistiques_reproductions' %}" class="btn btn-info">
                <i class="fas fa-chart-pie me-2"></i> Voir Statistiques
            </a>
        </div>
    </div>
</div>

<script>
    const lapinsCtx = document.getElementById('lapinsChart').getContext('2d');
    new Chart(lapinsCtx, {
        type: 'pie',
        data: {
            labels: ['M√¢les', 'Femelles'],
            datasets: [{
                data: {{ repartition_sexe|safe }},
                backgroundColor: ['#4e73df', '#1cc88a'],
            }]
        },
    });

    const naissancesCtx = document.getElementById('naissancesChart').getContext('2d');
    new Chart(naissancesCtx, {
        type: 'line',
        data: {
            labels: {{ mois|safe }},
            datasets: [{
                label: 'Naissances par mois',
                data: {{ naissances_mensuelles|safe }},
                borderColor: '#36b9cc',
                backgroundColor: 'rgba(54, 185, 204, 0.2)',
                fill: true
            }]
        },
    });
</script>
{% endblock %}
